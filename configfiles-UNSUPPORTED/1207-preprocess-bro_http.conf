# SOF-ELK Configuration File
# Author: Phil Hagen, Justin Henderson
# Email: phil@lewestech.com, jhenderson@tekrefresh.comes
# Last Update: 9/18/2017
#
# (C)2017 Lewes Technology Consulting, LLC
#
# This conf file is based on accepting logs for http.log from Bro systems

filter {
  if [type] == "bro_http" {
    # This is the initial parsing of the log
    csv {
      # If you use a custom delimiter, change the following value in between the quotes to your delimiter. Otherwise, insert a literal <tab> in between the two quotes on your logstash system, use a text editor like nano that doesn't convert tabs to spaces.
      separator => "	"

      columns => [ "timestamp", "uid", "source_ip", "source_port", "destination_ip", "destination_port", "trans_depth", "request_method", "hostname", "request", "referrer", "version", "agent", "source_bytes", "destination_bytes", "response_code", "response_phrase", "info_code", "info_phrase", "http_tags", "username", "password", "proxied", "source_fuid", "source_filename", "source_mimetype", "response_fuid", "response_filename", "response_mimetype" ]
    }

    mutate {
      # replace the "host" field with zeroes since we are loading from an archive file.  Will need a better way to do this in the future, though
      replace => { "host" => "0.0.0.0" }
    }
  }
}