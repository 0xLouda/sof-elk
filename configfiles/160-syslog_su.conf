filter {
    if [type] == "archive-syslog" or [type] == "syslog" {
        if [syslog_program] == "su" {
            grok {
                match => [ "message", "%{WORD:su_pam-module}\(su:%{WORD:su_pam-session}\): session %{WORD:su_event} for user %{USER:su_dest-user}(?: by \(uid=%{INT:su_source-uid}\))?" ]
                add_tag => [ "parse_done" ]
                tag_on_failure => [ "gpfail_su" ]
            }
        }
    }
}