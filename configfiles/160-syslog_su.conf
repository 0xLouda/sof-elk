filter {
    if [type] == "archive-syslog" or [type] == "syslog" {
        if [syslog_program] == "su" {
            grok {
                match => [ "message", "%{WORD:su_pammod}\(%{NOTSPACE:su_pamtype}\): session %{WORD:su_action} for user %{USER:su_destuser}(?: by \(uid=%{INT:su_sourceuid}\))?" ]
                add_tag => [ "parse_done" ]
                tag_on_failure => [ "gpfail_su" ]
            }
        }
    }
}