# SOF-ELK Configuration File
# (C)2016 Lewes Technology Consulting, LLC
#
# This file contains filters, transforms, and enrichments for other syslog messages

filter {
    if "process_syslog" in [tags] and !("parse_done" in [tags]) {
        # iptables firewall messages
        grok {
            patterns_dir => "/usr/local/sof-elk/grok-patterns"
            match => [ "message", "(?:\[%{BASE10NUM:uptime:float}\]%{SPACE})?%{IPTABLES}" ]
            add_tag => [ "got_iptables", "parse_done" ]
            tag_on_failure => [ "_defaultparse" ]
        }
    }
}