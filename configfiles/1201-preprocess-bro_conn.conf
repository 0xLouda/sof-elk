# Author: Justin Henderson
# Email: jhenderson@tekrefresh.comes
# Last Update: 5/10/2016
#
# This conf file is based on accepting logs for conn.log from Bro systems
filter {
  if [type] == "bro_conn" {
    # This is the initial parsing of the log
    csv {
      # If you use a custom delimiter, change the following value in between the quotes to your delimiter. Otherwise, insert a literal <tab> in between the two quotes on your logstash system, use a text editor like nano that doesn't convert tabs to spaces.
      separator => "	"

      columns => ["timestamp","uid","source_ip","source_port","destination_ip","destination_port","protocol","service","duration","source_bytes","destination_bytes","connection_state","source_local","destination_local","missed_bytes","history","source_packets","source_ipbytes","destination_packets","destination_ipbytes","tunnel_parents","source_countrycode","destination_countrycode","sensor_name"]
    }

    if [connection_state] {
    translate {
        dictionary_path => "/usr/local/sof-elk/lib/dictionaries/bro_connection_state2desc.yaml"
      field => "connection_state"
        destination => "connection_state_description"
      }
    }
  }
}
