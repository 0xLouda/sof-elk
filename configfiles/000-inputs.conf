input {

    # syslog, live via udp and tcp port
    syslog {
        port => 5514
        type => "syslog"
        use_labels => false
    }

    # archived syslog files, in standard /var/log/* format
    file {
        type => "archive-syslog"
        path => [ "/usr/local/logstash-syslog/**/*" ]
        sincedb_path => "/var/db/logstash/sincedb"
        start_position => "beginning"
        exclude => [ "*.gz", "*.zip" ]
    }

    # archived passivedns logs, which are not in syslog format by default.
    # note that if passivedns sends log entries via the syslog output, they
    # will be handled as syslog data, not here!!
    file {
        type => "archive-passivedns"
        path => [ "/usr/local/logstash-passivedns/**/*" ]
        sincedb_path => "/var/db/logstash/sincedb"
        start_position => "beginning"
        exclude => [ "*.gz", "*.zip" ]
    }

    # netflow v5, live via udp port
    udp {
        port => 9995
        codec => netflow {
            target => "nf"
        }
        type => "netflow"
    }

    # archived netflow, parsed to match output from the following nfdump command:
    # nfdump (-r <input file> | -R <input dir>) -q -N -O tstart -o "fmt:$EXP_IP %das %dmk %eng %ts %fl 0 %byt %pkt %in %da %nh %sa %dp %sp %te %out %pr 0 0 %sas %smk %stos %flg 0"
    file {
        path => [ "/usr/local/logstash-nfarch/**/*" ]
        type => "archive-netflow"
        sincedb_path => "/var/db/logstash/sincedb"
        start_position => "beginning"
        exclude => [ "*.gz", "*.zip" ]
    }

    # HTTP access logs, in any of the following formats:
    # <Apache Common Log Format>
    # <Apache Combined Log Format>
    # <virtual hostname> <Apache Common Log Format>
    # <virtual hostname> <Apache Combined Log Format>
    # <Apache default ssl_access_log format>
    file {
        type => "httpdlog"
        path => [ "/usr/local/logstash-httpd/**/*" ]
        sincedb_path => "/var/db/logstash/sincedb"
        start_position => "beginning"
        exclude => [ "*.gz", "*.zip" ]
    }

    # HTTP access logs, using syslog protocol via udp and tcp port
    syslog {
        port => 5515
        type => "httpdlog"
        use_labels => false
    }
}