filter {
    if [type] == "archive-syslog" or [type] == "syslog" {
        if [message] =~ "pam_*" {
            grok {
                match => [ "message", "%{WORD:pam_module}\(%{WORD:pam_service}:%{WORD:pam_sessiontype}\): session %{WORD:pam_event} for user %{USER:pam_destusername}(?: by \(uid=%{INT:pam_sourceuid}\))?" ]
                add_tag => [ "parse_done" ]
                tag_on_failure => [ "gpfail_pam" ]
            }
        }
    }
}